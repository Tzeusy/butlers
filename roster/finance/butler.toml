[butler]
name = "finance"
port = 40105
description = "Personal finance specialist for receipts, bills, subscriptions, and transaction alerts."

[butler.runtime]
model = "gpt-5.3-codex-spark"
max_concurrent_sessions = 3

[runtime]
type = "codex"

[butler.db]
name = "butlers"
schema = "finance"

[butler.switchboard]
url = "http://localhost:40100/mcp"
advertise = true
liveness_ttl_s = 300
route_contract_min = "route.v1"
route_contract_max = "route.v1"

[modules.email]

[modules.calendar]
provider = "google"

[modules.calendar.conflicts]
policy = "suggest"

[modules.memory]

[[butler.schedule]]
name = "upcoming-bills-check"
cron = "0 8 * * *"
prompt = """
Daily bills check. Use upcoming_bills(days_ahead=14, include_overdue=true) to surface bills due
in the next two weeks, ranked by urgency:
- Overdue bills first
- Bills due today
- Bills due this week
- Bills due within 14 days

Notify the owner via Telegram with the urgency-ranked list and total amount due.
If no bills are upcoming or overdue, do not send a message.
"""

[[butler.schedule]]
name = "subscription-renewal-alerts"
cron = "30 8 * * *"
prompt = """
Daily subscription renewal scan. Check for subscriptions renewing within the next 7 days.
For each upcoming renewal, include the service name, amount, and renewal date.

Flag any subscriptions where the user may want to review before auto-renewal.
Notify the owner via Telegram if any renewals are approaching.
If no renewals are upcoming, do not send a message.
"""

[[butler.schedule]]
name = "monthly-spending-summary"
cron = "0 9 1 * *"
prompt = """
Monthly spending summary. Use spending_summary for the previous calendar month, grouped by category.
Include:
- Total spend for the month
- Top spending categories with amounts
- Notable changes compared to the prior month (if data available)
- Any outstanding obligations carried forward

Notify the owner via Telegram with the formatted monthly overview.
"""
