[butler]
name = "home"
port = 40108
description = "Smart home automation orchestrator for comfort, energy, and device management"

[butler.runtime]
type = "codex"
model = "gpt-5.2"
max_concurrent_sessions = 3

[butler.db]
name = "butlers"
schema = "home"

[butler.switchboard]
url = "http://localhost:40100/mcp"
advertise = true
liveness_ttl_s = 300
route_contract_min = "route.v1"
route_contract_max = "route.v1"

[modules.home_assistant]
url = "http://localhost:8123/api/mcp"

[modules.memory]

[modules.contacts]
provider = "google"
include_other_contacts = false

[modules.contacts.sync]
enabled = true
run_on_startup = true
interval_minutes = 15
full_sync_interval_days = 6

[modules.approvals]

[[butler.schedule]]
name = "weekly-energy-digest"
cron = "0 9 * * 0"
dispatch_mode = "prompt"
prompt = """
Generate and send a weekly energy efficiency digest for the user. Analyze device usage patterns,
energy consumption trends, and inefficiencies from the past 7 days. Identify devices with high
energy usage, peak demand times, and opportunities for optimization. Include recommendations
for adjusting schedules or settings. Compose a structured summary highlighting energy savings
achieved and potential future savings. Deliver via notify() using the owner contact's preferred
channel.
"""

[[butler.schedule]]
name = "daily-environment-report"
cron = "0 8 * * *"
dispatch_mode = "prompt"
prompt = """
Generate and send a daily home environment report for the user. Check current temperature,
humidity, air quality, lighting levels, and other environmental metrics. Compare against
user's comfort preferences and alert if any readings are outside acceptable ranges. Provide
actionable recommendations (e.g., "humidity is low, consider running humidifier"). Deliver
via notify() using the owner contact's preferred channel.
"""

[[butler.schedule]]
name = "device-health-check"
cron = "0 4 * * *"
dispatch_mode = "prompt"
prompt = """
Perform a nightly device health check. Query all connected devices for status, battery levels,
last communication time, and firmware updates. Flag any devices that are offline, have low battery,
or are due for updates. Store health check results for trend analysis. If critical issues are found
(offline devices, imminent battery depletion), send an alert via notify().
"""

[[butler.schedule]]
name = "memory-consolidation"
cron = "0 */6 * * *"
dispatch_mode = "job"
job_name = "memory_consolidation"

[[butler.schedule]]
name = "memory-episode-cleanup"
cron = "5 4 * * *"
dispatch_mode = "job"
job_name = "memory_episode_cleanup"
