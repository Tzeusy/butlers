[butler]
name = "switchboard"
port = 40100
description = "Routes incoming messages to specialist butlers"

[butler.runtime]
model = "gpt-5.3-codex-spark"
max_concurrent_sessions = 3

[runtime]
type = "codex"

[buffer]
queue_capacity = 100
worker_count = 3
scanner_interval_s = 30
scanner_grace_s = 10
scanner_batch_size = 50

[butler.db]
name = "butlers"
schema = "switchboard"

[modules.telegram]

[modules.telegram.user]
enabled = false

[modules.telegram.bot]
token_env = "BUTLER_TELEGRAM_TOKEN"

[modules.memory]

[modules.email]

[modules.email.user]
enabled = false

[modules.email.bot]
address_env = "BUTLER_EMAIL_ADDRESS"
password_env = "BUTLER_EMAIL_PASSWORD"

# Connector statistics rollup and pruning jobs
[[butler.schedule]]
name = "connector-stats-hourly-rollup"
cron = "5 * * * *"
prompt = "Run the hourly connector statistics rollup job by calling the appropriate Python function to aggregate heartbeat data from the previous hour."

[[butler.schedule]]
name = "connector-stats-daily-rollup"
cron = "15 0 * * *"
prompt = "Run the daily connector statistics rollup job by calling the appropriate Python function to aggregate hourly data and compute uptime percentages for the previous day."

[[butler.schedule]]
name = "connector-stats-pruning"
cron = "30 1 * * *"
prompt = "Run the connector statistics pruning job to remove old heartbeat partitions, hourly stats, and daily stats according to retention policies."

[[butler.schedule]]
name = "memory-consolidation"
cron = "0 */6 * * *"
prompt = "Run memory consolidation to process unconsolidated episodes and extract facts and rules."

[[butler.schedule]]
name = "memory-episode-cleanup"
cron = "0 4 * * *"
prompt = "Run memory episode cleanup to delete expired episodes and enforce capacity limits."

# Butler registry liveness sweep
[[butler.schedule]]
name = "eligibility-sweep"
cron = "*/5 * * * *"
prompt = "Run the eligibility sweep by calling run_eligibility_sweep to evaluate butler liveness and transition eligibility states (active→stale→quarantined) based on liveness_ttl_seconds. Log a summary of any transitions."
